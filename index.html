<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>CSV to Plain Text Table</title>
  <meta name="description" content="">
  <meta name="author" content="Terri Ann Swallow">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="favicon.png">

<style type="text/css">
	textarea {
		font-family: monospace;
    resize: none;
	}
</style>
<script src="js/CsvToMarkdown.js"></script>
<script>
	"use strict";

	window.addEventListener('DOMContentLoaded', function () {
		var insertAtCursor = function (myField, myValue) {
			//IE support
			if (document.selection) {
				myField.focus();
				sel = document.selection.createRange();
				sel.text = myValue;
			}
			//MOZILLA/NETSCAPE support
			else if (myField.selectionStart || myField.selectionStart == '0') {
				var startPos = myField.selectionStart;
				var endPos = myField.selectionEnd;
				myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);
				myField.selectionEnd = myField.selectionStart = startPos + myValue.length;
			} else {
				myField.value += myValue;
			}
		};

		var input = document.getElementById('tsv-input');
		var output = document.getElementById('table-output');

		var headerCheckbox = document.getElementById('has-headers');
		var delimiterMarker = document.getElementById('delimiter-marker');
		var headerStyle = document.getElementById('header-style');

		var getDelimiter = function () {
			var delim = delimiterMarker.value;
			if (delim == 'tab') {
				delim = "\t";
			}

			return delim;
		};

		var getheaderStyle = function () {
			let style = headerStyle.value;
			let useDoubleHeader = false;
			if (style == '||') {
				useDoubleHeader = true;
			}
			return useDoubleHeader;
		};

		var populateData = document.getElementById('populate-data');

		input.addEventListener('keydown', function (e) {
			if (e.key.toLowerCase() == 'tab') {
				e.preventDefault();
				insertAtCursor(e.target, "\t");
			}
		});

		var renderTable = function () {
			var value = input.value.trim();
			var hasHeader = headerCheckbox.checked;

			output.value = csvToMarkdown(value, getDelimiter(), hasHeader, getheaderStyle());
		};

		input.addEventListener('keyup', renderTable);
		headerCheckbox.addEventListener('change', renderTable);
		delimiterMarker.addEventListener('change', renderTable);
		headerStyle.addEventListener('change', renderTable);

		populateData.addEventListener('change', function () {
			var header = populateData.value.split("|").join(getDelimiter()) + "\n";
			input.value = header + input.value;
			headerCheckbox.checked = true;
			populateData.selectedIndex = 0;
			renderTable();

			if (typeof input.selectionStart != 'undefined') {
				input.select();
				input.selectionEnd = input.selectionStart = input.value.length;
			}
		});

		output.addEventListener('click', function (e) {
			e.target.select();
		});

		renderTable();
	});

</script>
</head>
<body>
<a href="https://github.com/terriann/CsvToPlainTextTable"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a>
  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
    <div class="row">
      <div class="one-half column" style="margin-top: 5%">
        <h4>CSV to Plain Text Table</h4>
        <p>Turn your CSV into a Markdown or Confluence Markup style plain text table.</p>

        <div><a class="github-button" href="https://github.com/terriann/CsvToPlainTextTable" aria-label="Star terriann/CsvToPlainTextTable on GitHub">Star</a> <a class="github-button" href="https://github.com/terriann/CsvToPlainTextTable/fork" aria-label="Fork terriann/CsvToPlainTextTable on GitHub">Fork</a></div>

        <label><input type="checkbox" id="has-headers" /> Use first line as headers</label>
        <select id="header-style">
          <option value="|---|">Markdown</option>
          <option value="||">Confluence Markup</option>
        </select>
        <select id="delimiter-marker">
          <option value="tab">Tab Separated</option>
          <option value=",">Comma Separated</option>
          <option value=";">Semicolon Separated</option>
        </select>
        <select id="populate-data">
          <option>-- Populate With --</option>
          <option value="id|select_type|table|type|possible_keys|key|key_len|ref|rows|extra">MySQL EXPLAIN Headers</option>
          <option value="id|select_type|table|type|possible_keys|key|key_len|ref|rows|filtered|extra">MySQL EXPLAIN EXTENDED
            Headers
          </option>
        </select>
        <br>
        <textarea style="width: 100%; height: 200px;" id="tsv-input"></textarea>
      </div>
      <div class="one-half column" style="margin-top: 17%">
        	<textarea style="width: 100%; height: 350px;" id="table-output" readonly></textarea>
      </div>

      <div class="column twelve" style="text-align: center;">  
        <p><small>Hosted on GitHub <a href="https://github.com/terriann/CsvToPlainTextTable" target="_blank">terriann/CsvToPlainTextTable</a> &bull; Adapted from <a href="https://github.com/donatj/CsvToMarkdownTable" target="_blank">donatj/CsvToMarkdownTable</a></small></p>
      </div>
    </div>
  </div>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>
